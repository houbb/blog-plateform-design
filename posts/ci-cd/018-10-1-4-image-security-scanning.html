<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"镜像安全扫描: 容器镜像的漏洞检测与合规检查","image":[""],"datePublished":"2025-08-30T00:00:00.000Z","dateModified":"2025-09-07T09:02:25.000Z","author":[{"@type":"Person","name":"老马啸西风","url":"https://houbb.github.io"}]}</script><meta property="og:url" content="https://houbb.github.io/blog-plateform-design/posts/ci-cd/018-10-1-4-image-security-scanning.html"><meta property="og:site_name" content="老马啸西风"><meta property="og:title" content="镜像安全扫描: 容器镜像的漏洞检测与合规检查"><meta property="og:description" content="在容器化应用日益普及的今天，容器镜像已成为软件交付的核心载体。然而，容器镜像中可能包含各种安全漏洞和不合规的组件，这些风险会直接传递到生产环境中，造成严重的安全隐患。通过在CI/CD流水线中集成镜像安全扫描工具，团队能够在镜像构建阶段就发现并修复安全问题，实现"安全左移"的重要实践。本文将深入探讨镜像安全扫描的重要性、主流扫描工具的集成实践以及构建安全..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-07T09:02:25.000Z"><meta property="article:tag" content="CICD"><meta property="article:published_time" content="2025-08-30T00:00:00.000Z"><meta property="article:modified_time" content="2025-09-07T09:02:25.000Z"><title>镜像安全扫描: 容器镜像的漏洞检测与合规检查 | 老马啸西风</title><meta name="description" content="在容器化应用日益普及的今天，容器镜像已成为软件交付的核心载体。然而，容器镜像中可能包含各种安全漏洞和不合规的组件，这些风险会直接传递到生产环境中，造成严重的安全隐患。通过在CI/CD流水线中集成镜像安全扫描工具，团队能够在镜像构建阶段就发现并修复安全问题，实现"安全左移"的重要实践。本文将深入探讨镜像安全扫描的重要性、主流扫描工具的集成实践以及构建安全...">
    <link rel="preload" href="/blog-plateform-design/assets/style-Bb931w8d.css" as="style"><link rel="stylesheet" href="/blog-plateform-design/assets/style-Bb931w8d.css">
    <link rel="modulepreload" href="/blog-plateform-design/assets/app-JcJB06c7.js"><link rel="modulepreload" href="/blog-plateform-design/assets/018-10-1-4-image-security-scanning.html-CQ2z25mZ.js"><link rel="modulepreload" href="/blog-plateform-design/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/blog-plateform-design/assets/index.html-C9Yf9V4T.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/intro.html-7Co4nobf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-0-alarm-pain-and-paradigm-shift.html-DzXTpNEE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-1-traditional-alarm-challenges.html-muxPBS7a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-2-from-notification-tool-to-intelligent-hub.html-DfGaMYId.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-3-core-objectives-mttr-mtbf-slo-ux.html-DQ6poePY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-4-full-lifecycle-interpretation.html-BL4fbDeP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-2-0-theory-and-concepts.html-BwsoNbD3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-2-1-monitoring-data-system.html-BZhw6LEh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-2-2-alert-rule-design.html-COlbLTjl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-2-3-incident-vs-alert.html-C5dXTrP1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-2-4-slo-sli-error-budget.html-CKssfM7E.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-3-0-platform-planning-and-design.html-C953AFPl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-3-1-requirements-analysis-and-assessment.html-serAJT6J.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-3-2-design-principles.html-0DtwP2ZV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-3-3-technology-selection.html-C2khe_jV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-3-4-roadmap.html-qO_vcXk-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-2-1-0-overall-architecture-design.html-SMHDyFqK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-2-1-1-layered-architecture.html-BhVRzQRp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-2-1-2-microservices-design.html-BaOjtcfj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-2-1-3-high-availability-performance.html-CjI-qwtV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-2-1-4-api-first-integration.html-C-CWq3Ij.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-2-2-0-alert-lifecycle-management-part1.html-DjTtAt3Q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-2-2-1-unified-alert-ingestion.html-bznKOkcG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-2-2-2-powerful-rule-engine.html-C7CvGzup.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-2-2-3-core-noise-reduction-algorithms.html-oKgOd_J-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-2-2-4-event-noise-reduction-and-aggregation.html-CZRb4bcg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-2-3-0-alert-lifecycle-management-part2.html-CDErCntF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-2-3-1-notification-strategy-management.html-CQDC7hSa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-2-3-2-multi-channel-notification-routing.html-oTqdZbVx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-2-3-3-on-call-management-scheduling.html-BmjSpGje.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-2-3-4-response-collaboration.html-DupESHu8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-3-1-0-from-alert-to-action.html-BZXaQDQ4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-3-1-1-alert-ops-toolchain-integration.html-DR3Q-T80.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-3-1-2-auto-remediation.html-i1klCn1a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-3-1-3-closed-loop-verification.html-BoLgd7rh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-3-2-0-intelligent-analysis.html-BeA8lfrn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-3-2-1-topology-correlation.html-COZR9SE5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-3-2-2-metric-drill-down.html-BjDTs5uD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-3-2-3-log-trace-correlation.html-DCqTNC2D.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-3-2-4-intelligent-root-cause-analysis.html-BhsTqfaV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-3-3-0-incident-postmortem-knowledge.html-CVqE-_w-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-3-3-1-digital-incident-management.html-D3oAnHRS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-3-3-2-action-item-tracking.html-BNMylutA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-3-3-3-knowledge-base-integration.html-D9P6l8GE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-3-3-4-improvement-dashboard.html-CEIl5r55.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-3-4-0-sop-runbook-automation.html-BY9RWmMt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-3-4-1-digital-sop-implementation.html-C12DJTFY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-3-4-2-runbook-management.html-D956Ta0w.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-3-4-3-guided-incident-response.html-BCzqtGWq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-4-1-0-observability-continuous-optimization.html-CpYOBfW4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-4-1-1-platform-metrics-monitoring.html-rfgSwVdx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-4-1-2-alert-quality-assessment.html-Dss14axI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-4-1-3-alert-fatigue-monitoring.html-DiHSwy9U.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-4-2-0-deployment-governance-promotion.html-CI1RpHqm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-4-2-1-smooth-deployment-migration.html-C-hoIRth.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-4-2-2-alert-governance-standards.html-BTpQCGUV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-4-2-3-promotion-training.html-DPgXbFUU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-4-3-0-human-centered-design-overview.html-Cf5VWCsw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-4-3-1-reduce-user-disturbance.html-bqflHSpl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-4-3-2-psychological-safety-culture.html-B6mQDEC0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-4-3-3-user-experience-optimization.html-9RR4rFKA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-4-4-0-aiops-capabilities-overview.html-YOHL_Zx1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-4-4-1-anomaly-detection.html-DqIkPjlr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-4-4-2-predictive-alerting.html-B9eYq6so.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-4-4-3-intelligent-scheduling.html-Cnqbg56a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-4-5-0-future-prospects-overview.html-BkeOqZ8c.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-4-5-1-observability-driven-development.html-B6oJzQRe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-4-5-2-cross-team-collaboration.html-BlK6uWds.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-4-5-3-chaos-engineering-alert-validation.html-DZVzWYvq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-appendix-a-open-source-alerting-systems-comparison.html-DPe998mY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-appendix-b-alert-rule-patterns-anti-patterns.html-Bk190ZmV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-appendix-c-classic-incident-postmortem-template.html-qG4H8IJk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-appendix-d-glossary.html--ilsld2g.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-bpm-core-automation-monitoring-optimization.html-GIhqpczD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-bpm-oa-workflow-rpa-discrimination-fusion.html-Bc3XZ9t_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-README.html-C9QENBWG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-digital-transformation-process-engine-overview.html-DDxeXavU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-10-1-real-time-monitoring-dashboard.html-D75LGias.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-10-2-process-mining-technology.html-y_2szZkt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-10-3-kpi-metrics-system.html-KIHT_--2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-10-README.html-BF_Gag_R.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-10-monitoring-analysis-optimization-overview.html-CTOGt-g1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-11-1-identity-authentication-integration.html-D___zADo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-11-2-organizational-structure-synchronization.html-C4skP6Se.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-11-3-business-system-integration.html-eqy4ye1r.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-11-4-document-management-system-integration.html-BX2BXaJI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-11-README.html-51y9pfuW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-11-enterprise-ecosystem-integration-overview.html-BlGD2piT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-12-1-permission-system-design.html-BtHlxHO2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-12-2-operation-log-audit.html-CzC3nIg4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-12-3-compliance-check.html-DnBBcO94.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-12-4-data-encryption-masking.html-BdTeQs-o.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-12-README.html-CPSDpO_9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-12-security-compliance-audit-overview.html-gWli9C9W.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-13-1-phased-implementation-strategy.html-CWtzq70d.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-13-2-training-community-building.html-Cx3irMe0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-13-3-change-management.html-emy3abQf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-13-4-operations-support-system.html-Bc2kwbRB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-13-README.html-BtGhTuka.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-13-implementation-promotion-change-management-overview.html-CEGwxmHz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-14-1-ai-applications-in-bpm.html-DourfFDv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-14-2-rpa-integration.html-Qc7C2FWj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-14-3-intelligent-decision-making.html-C1-bQo6v.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-14-README.html-CeE1uvqv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-14-intelligent-bpm-rpa-integration-overview.html-BJ6_QvN6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-15-1-low-code-platform-bpm.html-BA8aoncq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-15-2-platform-capability-boundaries.html-DfmyG7WU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-15-3-governance-and-control.html-DXKZfP0q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-15-README.html-DXdY65On.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-15-low-code-citizen-development-overview.html-Cg88wAEX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-16-1-bpm-technology-trends.html-DlN4O5RG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-1-16-2-emerging-technology-integration.html-ByNymioI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-1-16-3-business-model-innovation.html-CuYaPl7q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-1-16-README.html-B8VtOtOv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-1-16-future-outlook-technology-evolution-overview.html-BnY4QXLs.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-1-2-1-business-process-lifecycle-theory.html-CuP3E1Jg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-1-2-2-bpmn-2.0-standard-detailed-explanation.html-BqSSscPo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-1-2-3-other-important-standards-dmn-cmmn.html-CZm8EuMV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-1-2-4-characteristics-of-excellent-processes.html-DBUJ2HN_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-1-2-README.html-RYaGgq99.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-1-2-bpm-core-theory-standards-overview.html-muy4G-pm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-1-3-1-process-inventory-identification.html-BWXZyRw-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-1-3-2-business-blueprint-development.html-BI-syXBy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-1-3-3-platform-selection-decision.html-BtyzQHyo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-1-3-4-evolution-roadmap-design.html-BuQnIC8a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-1-3-README.html-BJgdBZix.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-1-3-project-initiation-master-planning-overview.html-W2D634Cw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-1-4-1-layered-architecture-design.html-CGy-OXf3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-1-4-2-core-engine-microservices.html-vqqPPH4t.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-1-4-3-high-availability-performance-design.html-B3QQMi7v.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-1-4-4-multi-tenancy-data-isolation-design.html-D9et5KEY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-1-4-README.html-C8cIZUCm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-1-4-platform-architecture-design-overview.html-1PIXUOC3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-1-5-1-process-definition-deployment-model.html-Cg7cMzIv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-1-5-2-process-instance-runtime-control.html-DI9rxq_6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-1-5-3-task-management.html-Cma4OgGt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-1-5-4-process-routing-gateway.html-vZTkgbNU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-1-5-README.html-BMh0N0d3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-1-5-process-engine-design-implementation-overview.html-B3KddMDZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-1-6-1-dynamic-form-engine.html-BJbspV-Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-1-6-2-differentiated-interface-design.html-DQ_dQliU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-1-6-3-mobile-adaptation-experience-optimization.html-BE3eeln6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-1-6-README.html-DxXC03Fb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-1-6-form-interface-design-overview.html-DNMRWZRA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-1-7-1-rule-engine-integration.html-kVibl454.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-1-7-2-service-calls-integration.html-BdGR0oyi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/074-1-7-3-messaging-event-driven.html-B50-vKJI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/075-1-7-README.html-CrVPuf8O.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/076-1-7-business-rules-integration-capabilities-overview.html-CcIm5QJB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/077-1-8-1-process-mining-梳理.html-BeaJZba_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/078-1-8-2-process-modeling-best-practices.html-UbrwXa5w.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/079-1-8-3-version-control-deployment.html-BZgM2S9z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/080-1-8-README.html-C3NxYZpo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/081-1-8-process-design-development-overview.html-1C37pcWp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/082-1-9-1-task-assignment-strategies.html-BOcAl2-T.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/083-1-9-2-task-notification-reminders.html-CwjAahBd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/084-1-9-3-task-operations-support.html-C0p1uBuM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/085-1-9-4-task-delegation-proxy.html-VGaE50nt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/086-1-9-README.html-DIAfzDY_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/087-1-9-human-task-collaboration-overview.html-C3UKA85b.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/088-appendix-a-bpm-platform-roadmap.html-Ci2LUKPN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/089-appendix-b-bpm-platform-selection-guide.html-ChbgGELk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/090-appendix-c-bpm-platform-performance-optimization.html-BXHGTBUH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/091-appendix-d-bpm-terminology-glossary.html-DQufEjPT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-from-manual-deployment-to-continuous-delivery.html-D34bQLcp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-ci-cd-cd-concepts.html-BC-Qvi6I.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-devops-culture-and-ci-cd.html-E8ngILYN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4-end-to-end-pipeline.html-BirqMyYx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-digital-transformation-engine-core-value.html-BXvtyTEt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-2-1-foundation-components.html-CephnFZf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-2-2-key-principles.html-sm0cavvh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-2-3-metrics.html-DhGBFs2o.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-2-core-concepts-and-principles.html-DTcJMgmH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-3-1-requirements-analysis.html-CojtbXf0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-3-2-technology-selection.html-DRT1WtIe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-3-3-design-principles.html-CAjGiWnz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-3-4-evolution-roadmap.html-CccrmdnE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-3-strategic-planning.html-DqGVqExt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-10-1-1-left-shift-security-practices.html-BAFEFnHp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-10-1-2-secrets-credentials-management.html-CcAISaVc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-10-1-3-compliance-as-code.html-u1IjeX9V.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-10-1-security-compliance-devsecops.html-Bllzv_nZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-11-1-1-pipeline-visualization.html-CCCvo9Cy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-11-1-2-platform-monitoring.html-ZKtcBZEq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-11-1-3-rd-effectiveness-metrics.html-BddwJnAD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-11-1-4-effectiveness-metrics-practice.html-BsyuQLSp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-11-1-observability-effectiveness-metrics.html-DyvDPLke.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-12-1-1-pipeline-template-library.html-ChPAwHWe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-12-1-2-multi-tenancy-permission-management.html-YxkagYK0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-12-1-3-promotion-empowerment.html-DVFZzSV0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-12-1-4-common-issues-pitfall-guide.html-6nDs4zyp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-12-1-platform-operations-best-practices.html-DSSfzZqr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-13-1-1-project-management-integration.html-B59vF73Q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-13-1-2-monitoring-system-integration.html-7me5SJUz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-13-1-3-communication-tools-integration.html-D8a25aCA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-13-1-4-serverless-faas-integration.html-r76tUdsc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-13-1-ecosystem-integration.html-Bh-rymfh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-14-1-1-gitops-core-concepts.html-C3uNgyku.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-14-1-2-gitops-with-argocd-fluxcd.html-BBhQeUTT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-14-1-3-unified-delivery-of-applications-and-infrastructure.html-JWjUaL5e.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-14-1-gitops-practice.html-B1YSfpZ3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-15-1-1-intelligent-test-optimization.html-BqVu9GTw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-15-1-2-intelligent-resource-scheduling-cost-optimization.html-De2u6fxX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-15-1-3-intelligent-root-cause-analysis.html-BE9R2wsi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-15-1-aiops-in-cicd.html-Bnjh4Nq4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-16-1-1-idp-and-cicd.html-8me0A0Ou.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-16-1-2-security-compliance-automation.html-HRtfsksG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-16-1-3-cloud-native-cicd-paradigms.html-C3XsNMVe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-16-1-future-evolution-trends.html-B-QPRkDS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-2-1-1-layered-architecture.html-BC6JPkCQ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-2-1-2-core-services.html-Crr8N_v0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-2-1-3-high-availability-elasticity.html-D3nt5h1M.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-2-1-4-api-first-plugin-design.html-DdDotF-j.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-2-1-platform-architecture-design.html-Dxn4Gwah.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-2-2-1-pipeline-as-code.html-CfxnWzxg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-2-2-2-pipeline-core-model.html-BIv38vBr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-2-2-3-execution-environment-isolation.html-B2VoGdci.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-2-2-4-pipeline-control-flow.html-Zq6Qd7yD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-2-2-pipeline-engine-design.html-CXt8BLpJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-2-3-1-git-integration.html-Dg8x-sVZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-2-3-2-branch-strategy-pipeline-trigger.html-BTjeTLPe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-2-3-3-code-scanning-quality-gate.html-BLZhyjCP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-2-3-4-change-correlation.html-DGEKT72Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-2-3-code-management-integration.html-DDDfF7BJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-3-1-1-multi-language-build.html-39_2NwTZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-3-1-2-build-acceleration.html-qrCopCcK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-3-1-3-artifact-repository.html-m0yg5zQV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-3-1-4-immutable-artifacts-promotion.html-DvRPaJwl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-3-1-build-artifact-management.html-Ctw5-H1f.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-4-1-1-test-pyramid-implementation.html-DgBqltRO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-4-1-2-test-management-execution.html-DPLKjxHM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-4-1-3-quality-gate-settings.html-B5qmunu8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-4-1-automated-testing-integration.html-CnWMT3es.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-5-1-1-environment-management-isolation.html-DN_BKvIH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-5-1-2-deployment-strategy-details.html-DsSYWCV1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-5-1-3-kubernetes-integration.html-BbKu1eqo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/074-5-1-4-approval-security-control.html-UwY81xOG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/075-5-1-deployment-release-strategies.html-KG6PEpuM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/076-8-1-1-pipeline-template-library.html-BG5wqbxc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/077-8-1-2-multi-tenancy-permission-management.html-ZSHsCYUc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/078-8-1-3-promotion-empowerment.html-0tWGYiVg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/079-8-1-4-common-issues-pitfall-guide.html-BkdoQ2rm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/080-8-1-platform-operations-best-practices.html-ez5ElDHG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/081-9-1-1-project-management-integration.html-BE39CtkI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/082-9-1-2-monitoring-system-integration.html-C80O3a2f.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/083-9-1-3-communication-tools-integration.html-CAebl7s8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/084-9-1-4-serverless-faas-integration.html-D-AoH9s-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/085-9-1-ecosystem-integration.html-CmZYHfif.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/086-appendix-a-cicd-tools-comparison.html-DZkKHl48.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/087-appendix-b-pipeline-configuration-guide.html-Ci1xXYFn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/088-appendix-c-dockerfile-best-practices.html-BuQqZCou.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/089-appendix-d-glossary.html-DPZQEPTW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1_the-core-value-of-cmdb.html-BW3t-R0u.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2_redefining-cmdb.html-DWWFqgsi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3_common-mistakes-and-failure-analysis.html-_XHIE658.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4_the-essence-of-practical-and-full-lifecycle.html-BtT1JasO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-15-1-1_from-cmdb-to-ops-data-platform.html-md42vvpS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-15-1-2_data-governance-in-ops-practice.html-CqsZVOLM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-15-1-3_analysis-and-decision-making-based-on-full-ops-data.html-iqovKPfD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-2-1-1_configuration-items.html-0ocTxGzG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-2-1-2_ci-relationships.html-CLkuoWwo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-2-1-3_data-model-design.html-D87ouqwF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-2-1-4_consumption-scenario-driven-design.html-CYC830Ll.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-3-1-1_goal-setting-and-scope-definition.html-DqGV3PrM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-3-1-2_team-building-and-collaboration.html-eWJv7m6K.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-3-1-3_technology-selection.html-Cfcqv_Cu.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-3-1-4_evolution-roadmap.html-B3hLv0dP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-4-1-1_layered-architecture.html-D1r599me.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-4-1-2_core-module-design.html-UV5qwk70.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-4-1-3_high-availability-and-performance-design.html-BFQ6GpSf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-4-1-4_api-first-design.html-zM3M7Cn5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-5-1-1_basic-ci-model-design.html-DHn2Y65E.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-5-1-2_relationship-type-definition.html-DZsxOkBn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-5-1-3_metadata-management.html-CN_Mwb8I.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-5-1-4_flexible-custom-fields-and-model-extension.html-Db84mQfL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-6-1-1_automation-is-the-only-guarantee-of-accuracy.html-D-lVHPJr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-6-1-2_multi-mode-collection-integration.html-BSUU9l_4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-6-1-3_discovery-strategy-and-scheduling.html-DuiKUsdE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-6-1-4_data-cleaning-validation-and-compliance.html-BwXxzq1N.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-7-1-1_change-processes-and-cmdb-integration.html-DMP6t9fK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-7-1-2_data-freshness-strategy.html-L35izxuY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-7-1-3_data-quality-monitoring.html-Dc30h-MC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-7-1-4_permissions-and-auditing.html-Cib90V42.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-appendix-a_open-source-cmdb-system-comparison.html-DWmOgOcv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-appendix-b_common-auto-discovery-tools-and-protocols.html-B8hm96cy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-appendix-c_ci-model-design-examples.html-mhSNd74U.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-appendix-d_glossary.html-ZJxHg_4Z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-digital-transformation-data-core.html-y3UhNx7L.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-from-manual-dba-to-platform-service.html-pfpBzbEN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-platform-management-four-goals.html-Bu30eOh1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-10-1-resource-utilization-analysis.html-D_zcCR_v.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-10-2-instance-lifecycle-management.html-CS5lF1qL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-10-3-cost-optimization-and-resource-governance.html-9CJRDK5J.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-11-1-platform-implementation-strategy.html-BmRnFXJ5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-11-2-change-management-practices.html-CndFBdz1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-11-3-integration-with-existing-processes.html-_6NCf2FB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-12-1-role-and-permission-model-design.html-Dli7pAne.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-12-2-ticket-review-sop.html-DpMvp3ow.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-12-3-contingency-plan-and-continuous-optimization.html-CZOy5BwF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-13-1-common-technical-pitfalls.html-D8YfJfmd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-13-2-process-pitfall-avoidance.html-CJLFHGr7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-13-3-classic-case-study.html-D5bi5LzC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-14-1-intelligent-anomaly-detection.html-BMaC_D32.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-14-2-self-healing-and-autonomous-capabilities.html-Df5RS4ZM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-14-3-intelligent-optimization-techniques.html-BF6xpkwg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-15-1-kubernetes-operator-pattern.html-BD6A3e2v.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-15-2-serverless-database-integration.html-CWIlZoAp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-15-3-data-mesh-philosophy.html-BTYDUKzf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-16-1-open-source-platform-comparison.html-BDVUPVOM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-16-2-sql-review-rules.html-Dvxs_6z1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-16-3-core-monitoring-metrics.html-CHg5kKKt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-16-4-glossary.html-bVtD8rTc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-2-1-multi-engine-unified-management.html-DNGfdTXA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-2-2-management-scope-details.html-BqklTJcI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-2-3-core-process-analysis.html-RFqNeP3x.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-3-1-current-status-assessment-methodology.html-BiDlUl95.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-3-2-design-principles-detailed.html-E21FtEPE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-3-3-technology-selection-and-roadmap.html-_jPfBUMZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-4-1-platform-architecture-design.html-DSVQWfzL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-4-2-core-services-design.html-Cw2KIPPN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-4-3-high-availability-design.html-brNdMsFd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-5-1-metadata-collection-mechanism.html-C52jSeKg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-5-2-metadata-model-design.html-B12BEGoe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-5-3-data-lineage-and-impact-analysis.html-CfHyozdi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-6-1-sql-ticket-process-detailed.html-BNuFrNyb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-1-6-2-automated-audit-mechanism.html-BOy0WQNA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-1-6-3-execution-mode-and-osc-integration.html-DfuGLPt2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-1-7-1-unified-query-entry-design.html-CQDcCp98.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-1-7-2-query-limitations-and-resource-control.html-CmktBkbE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-1-7-3-sensitive-data-control.html-c0SLJD67.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-1-8-1-full-link-monitoring-system.html-CBxlP5rR.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-1-8-2-performance-analysis-and-diagnosis.html-BJrmru7S.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-1-8-3-capacity-forecasting-and-auto-scaling.html-Cd7fbdFU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-1-9-1-high-availability-solution-management.html-eRBhHFNu.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-1-9-2-backup-recovery-integration.html-BD2b2NbJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-1-9-3-data-security-and-compliance.html-B_nwtMMh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-从技术支持到服务赋能.html-C62Vfy8R.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-ITSM-ITIL-DevOps辨析概念融合实践.html-CwV2H1D4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-常见失败原因分析.html-bmKl61tO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4-可落地的全生命周期内涵.html-BsZ8JEXn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-数字化时代的IT服务管理新范式.html-BbgLouux.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-2-1-ITIL4核心体系.html-CPAfIwkr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-2-2-服务台单一联系点与用户体验门户.html-Bnwdzu_z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-2-3-事件管理尽快恢复服务.html-CtUSXIe_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-2-4-问题管理根治潜在原因.html-s3J-ehsT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-2-5-变更管理平衡风险与敏捷.html-CBDTk1bz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-2-6-服务请求管理标准化与自动化.html-MmVJbcQo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-2-7-服务级别管理定义和衡量服务质量.html-Csxfz31Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-2-8-知识管理.html-CpWlG-D1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-2-9-配置管理与持续改进.html-9MV0BTRV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-2-核心框架与最佳实践.html-HuBf2Rs5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-3-1-现状评估与差距分析.html-DmCuIZcS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-3-2-制定业务案例与明确投资回报.html-D2RkcIVn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-3-3-技术选型.html-CsTa05Sj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-3-4-演进路线图.html-DjSSFx47.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-3-项目启动与总体规划.html-D0LgetRa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-4-1-分层架构.html-B6Wzx0Q9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-4-2-核心数据模型.html-Co5vTQnC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-4-3-高可用与性能设计.html-1FCZoFrE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-4-4-可扩展性设计.html-DFYkHbuE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-4-平台总体架构设计.html-CRE5Spux.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-5-1-多通道接入.html-DQ_BbCgi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-5-2-服务目录设计.html-Dp4pVyQQ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-5-3-服务请求全生命周期管理.html-BCyr9pZv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-5-4-用户体验与交互设计.html-CVR3YwR6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-5-服务体验与门户设计.html-CEKfJmdn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-6-1-工单模型与状态机设计.html-BMBToD6s.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-6-2-可视化流程设计器.html-BYdy9vJC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-6-3-自动化规则引擎.html-CRe39A-R.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-6-4-SLA管理引擎.html-DkZNhJza.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-6-核心流程引擎实现.html-DwVwdHmh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-7-1-知识生命周期管理.html-HhJHMGNc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-7-2-知识关联与智能推荐.html-C4LpjoKG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-7-知识库管理.html-BptJ-gJo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-10-1-度量指标体系-基于ITIL的KPI设计.html-DWZJVDa1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-10-2-可视化报表与仪表盘-为不同角色提供视图.html-fzEVWvF8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-10-3-持续改进循环-基于数据驱动流程优化.html-C36SD5j-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-10-4-满意度评价与反馈收集-衡量内部客户体验.html-DVc-p990.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-10-报表-分析与持续改进.html-DqUMH4iY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-11-1-第一阶段-搭建服务台-实现事件和服务请求管理.html-BEWcICpx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-11-2-第二阶段-落地问题管理和变更管理-集成CMDB.html-wNNMSliW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-11-3-第三阶段-深化知识管理-实现与外部工具链全面集成.html-BysnQ1SU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-11-4-变革管理-沟通-培训-克服阻力.html-usQYbIMn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-11-分阶段实施与推广策略.html-Cgg-Y8jw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-12-1-角色与职责定义-RACI-服务台经理-流程经理-技术支持团队.html-B-Tcx1sS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-12-2-平台运营SOP-用户支持-流程配置-权限管理.html-BxV_YBze.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-12-3-培养内部专家与社区-建立最佳实践分享机制.html-DN5MBzwI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-12-平台运营与团队建设.html-EUL4ba2R.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-13-1-流程设计陷阱-过度流程化与缺乏控制.html-CiQbiuCR.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-13-2-技术陷阱-CMDB脱节与集成复杂度低估.html-qUWJQS3Q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-13-3-人员陷阱-文化冲突技能不足缺乏认同.html-WTR6dmKw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-13-4-成功要素总结-领导力文化流程技术缺一不可.html-DS3N80dm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-13-最佳实践与常见陷阱.html-DKd6Rnns.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-14-1-敏捷变更管理-为高速开发的IT组织提供安全护栏.html-_jlFdEdM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-14-2-将ITSM实践左移-在开发阶段考虑运维和支持.html-CHn_y0ML.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-14-3-企业服务管理-将ITSM能力拓展至HR财务行政等业务部门.html-CeHQwcPs.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-14-ITSM与DevOps敏捷的融合.html-BuATolak.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-15-1-AI在ITSM中的应用-智能分派聊天机器人根因分析预测.html-Bhc9p33E.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-15-2-无接触解决-通过自动化实现自愈.html-_vMEi6sV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-15-3-ITOA-基于大数据进行趋势预测和风险防范.html-CqjpVXEt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-15-4-从成本中心到价值中心-展现IT对业务的贡献.html-G3QKS4R1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-15-智能化与未来趋势.html-Calc4NOG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-8-1-与监控系统集成-自动生成事件工单.html-D5Ez4bSP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-8-2-与CMDB集成-建立服务-资产-工单的关联关系.html-BffWhc5c.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-8-3-与自动化作业平台集成-自动处理常见请求和事件.html-1owMsLSv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-8-4-与协作工具-IM-邮件系统集成-实时通知与更新.html-BbFRP0id.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-8-作为运维中枢的集成能力.html-ykTChc4S.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-9-1-CMDB是ITSM的基石-为什么没有CMDB-ITSM就是空中楼阁.html-E7K3IMmY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-9-2-数据模型设计-配置项-CI-类型-属性-关系.html-BJOgOmYK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/074-9-3-自动发现与数据保鲜-与自动化工具-云平台-监控系统集成.html-DFntlJsx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/075-9-4-CMDB运营治理-确保数据的准确性与可信度.html-C8UBe5Xt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/076-9-配置管理数据库-CMDB-建设.html-BySM03wt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/077-A-主流ITSM平台对比指南.html-CcuxU9hP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/078-B-关键流程工作流设计示例.html-Cb-HpdIz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/079-C-KPI定义与计算公式表.html-BPS0yc-v.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/080-D-术语表.html-osknXihJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-log-generation.html-Cl0_KA9C.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-log-flow-path.html-Bc_jWld2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-log-lifecycle-model-overview.html-CMDH_jTi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-2-1-structured-vs-unstructured-logs.html-BDTvajSf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-2-2-log-types-event-audit-access-metric.html-BRpMzWh7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-2-3-hot-cold-archive-logs.html-BNi7TyKT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-2-log-classification-characteristics-overview.html-CVZ8dckG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-2-1-1-log-levels-context-formatting.html-D6msqKGj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-2-1-2-log-desensitization-compliance.html-6Cy6IPoB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-2-1-3-log-performance-optimization.html-B6r0UUDc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-2-1-log-output-standards-overview.html-zAOVuzc7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-3-1-1-collection-tools-agents.html-BCVzAyu9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-3-1-2-log-transport-pipeline.html-DbLjbnpq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-3-1-log-collection-transport-overview.html-CDLqk7nL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-4-1-1-storage-architecture-design.html-Z7jPZU0F.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-4-1-2-log-archiving-lifecycle-management.html-43O33cIB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-4-1-log-storage-archiving-overview.html-DK3FhH9G.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-5-1-1-log-parsing.html-i43zhI9W.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-5-1-2-log-processing-enhancement.html-CWUt2YPJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-5-1-log-parsing-processing-overview.html-CYNyUCRX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-6-1-1-log-search-engines.html-B29CMBYH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-6-1-2-log-visualization.html-abK8Fwgu.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-6-1-3-log-query-optimization.html-QCAlhFyc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-6-1-log-search-display-overview.html-CD2Fl-Bb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-7-1-1-log-driven-alerting.html-CY36lXG-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-7-1-2-log-metrics-fusion.html-CqEwegzv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-7-1-log-alerting-metricization-overview.html-aei2rmgs.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-8-1-1-multi-tenancy-and-permission-management.html-B-PM__d6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-8-1-2-log-cost-management.html-CTSI2JiJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-8-1-3-log-platform-devops-sre.html-Ccy_xTHr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-8-1-log-platform-capabilities-overview.html-DI5QmjFF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-9-1-1-intelligent-log-analysis.html-16gXfFwA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-9-1-2-log-compliance.html-59n4EPRc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-9-1-3-log-platform-future.html-4hbMbDc_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-9-1-appendix.html-D0k8B-js.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-9-1-log-platform-advanced-future-overview.html-CELDTh4s.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-from-experientialism-to-dataism.html-DeLT0dGQ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-core-value-of-measurement.html-DtQKavba.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-defining-all-things-as-indicators.html-B6VjRHaq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4-avoiding-measurement-traps.html-BpLPX5ZU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-digital-enterprise-core-competitiveness.html-DIXh53Z5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-10-1-1-rd-efficiency-measurement.html-BgRSQ_8a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-10-1-2-system-reliability-measurement.html-Dn1zSk9Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-10-1-3-cost-efficiency-measurement.html-Dkwt-0Q8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-10-1-key-application-scenarios.html-BDdg6yu_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-11-1-1-phased-implementation.html-1rxMfNBt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-11-1-2-change-management.html-CS2jnmMM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-11-1-3-lighthouse-projects.html-Cf39ayXZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-11-1-4-training-and-empowerment.html-LfDllUgq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-11-1-platform-implementation-and-promotion.html-B6iZ_iob.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-12-1-1-establishing-data-governance-committee.html-DQOZ-9Ds.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-12-1-2-platform-health-metrics.html-Q0_Uwqj_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-12-1-3-indicator-lifecycle-management.html-RJ9Jqwjy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-12-1-4-continuous-feedback-and-iteration.html-d_EWYSa6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-12-1-operation-governance-and-continuous-improvement.html-DAX6Pb40.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-13-1-1-predictive-analytics.html-B3h3TkHY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-13-1-2-optimization-recommendations.html-DOZbZrUa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-13-1-3-causal-inference.html-CVO4TysC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-13-1-intelligent-insights-and-prediction.html-BiDBVilL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-14-1-1-ai-native-measurement-platform.html-D1sk3MEv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-14-1-2-deep-integration-and-automation.html-sgxGtd7A.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-14-1-3-privacy-protection-and-compliant-computing.html-DvBcFXCO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-14-1-4-measurement-as-code.html-Cy2G9e2L.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-14-1-future-trends-and-forward-looking.html-BaoHLcH1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-2-1-1-classic-model-analysis.html-BA3ahFLY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-2-1-2-building-enterprise-measurement-system.html-DvkFYn3a.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-2-1-3-indicator-hierarchy-management.html-DTkiDYGy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-2-1-4-data-literacy-culture-building.html-BfHZKG96.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-2-1-measurement-dimensions-and-systematic-design.html-DIHLbn7F.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-3-1-1-current-situation-assessment.html-Db6fF6nU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-3-1-2-defining-platform-objectives.html-IkQOBMx7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-3-1-3-technology-selection.html-qugOJXB6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-3-1-4-evolution-roadmap.html-DvDGGlqc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-3-1-platform-strategy-and-top-level-planning.html-CfGMBw5L.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-4-1-1-layered-architecture.html-Dz40s4Wc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-4-1-2-core-component-design.html-B9HNGaiH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-4-1-3-high-performance-and-scalability.html-DPdEI_F1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-4-1-4-permissions-and-data-security.html-D94w9etw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-4-1-platform-architecture-design.html-vNjtZo1e.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-5-1-1-multi-source-data-access.html-SFKwkD1r.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-5-1-2-data-collection-methods.html-koDMJPw_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-5-1-3-data-standardization.html-jji0Za25.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-5-1-data-collection-and-integration.html-eFf5pz_4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-6-1-1-storage-selection.html-DFmX6kkN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-6-1-2-computing-engine.html-DrCSYofY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-6-1-3-data-quality-management.html-Cw3Ssv1S.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-6-1-4-metadata-management.html-Sl8aV661.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-6-1-data-storage-and-computing.html-kTWWW0FT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-7-1-1-indicator-registration-and-management.html-jaD9aAit.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-7-1-2-avoiding-indicator-ambiguity.html-CWdfVtbf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-7-1-3-derived-and-composite-indicators.html-ByjygHkf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-7-1-4-api-service-for-indicators.html-DSvxH3Io.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-7-1-indicator-definition-and-service-center.html-DWC8-Gcy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-8-1-1-configurable-dashboards.html-NAcvr-Ua.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-8-1-2-role-based-views.html-BQbAbLJd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-8-1-3-drill-down-and-slice-dice.html-D5ksZXB9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-8-1-4-natural-language-query-and-voice-interaction.html-CWipOyD7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-8-1-visualization-reports-and-insights.html-cu05ZzlX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-9-1-1-trend-comparison-correlation-analysis.html-dQxW2uaK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-9-1-2-intelligent-baseline-and-anomaly-detection.html-B7z3mp92.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-9-1-3-alerting-and-notification.html-gVfUvdZ9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-9-1-4-root-cause-analysis-recommendation.html-CJFY2H_t.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-9-1-analysis-and-alerting.html-BvpoQNXN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-appendix-a-open-source-tool-stack-selection-guide.html-6zFhxK_t.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-appendix-b-classic-indicator-definition-manual.html-C-F2Hhh3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-appendix-c-classic-case-studies.html-DA6YT7fW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-appendix-d-glossary.html-mJ0hwx60.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-appendix.html-D8gc8A1S.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-why-code-quality-is-the-foundation-of-efficiency.html-B4FylnHa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-the-three-pillars-of-engineering-efficiency.html-C0T_YeF-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-redefining-development-efficiency.html-DLP_7K7u.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-10-1-class-and-dependency-conflict-detection.html-CKM9P05Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-10-2-code-duplication-and-copy-paste-detection.html-BZ3WqYur.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-10-3-architecture-governance-and-anti-corruption-layer.html-D-HXRItr.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-10-4-ai-assisted-code-review-and-defect-prediction.html-DTt4JUTI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-10-intelligent-analysis-and-enterprise-governance.html-DLe3ktb6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-11-1-phase-1-foundational-scanning-and-quality-gates.html-BS3OPXUn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-11-2-phase-2-metrics-system-and-technical-debt-management.html-BGh5Va1s.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-11-3-phase-3-knowledge-base-and-intelligent-insights.html-BQhCB0ck.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-11-4-promotion-techniques-and-best-practices.html-CPwKjrbB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-11-phased-implementation-and-promotion-strategy.html-OfM-sVDV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-12-1-roles-and-responsibilities-collaboration.html-Cy1ATz42.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-12-2-operational-sop-rules-updates-fault-handling-user-support.html-C9X-geP1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-12-3-data-driven-improvement-review-and-optimization.html-BWlGzPW3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-12-4-feedback-channels-and-community.html-OYKarCLS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-12-platform-operations-and-performance-improvement.html-C406wwPE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-13-1-building-quality-culture-and-shared-awareness.html-B_F_V7GG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-13-2-training-and-advocacy-writing-manuals-hosting-workshops-sharing-cases.html-8XMksuEt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-13-3-balancing-quality-and-speed-avoiding-over-process-and-maintaining-agility.html-Z4oWRfhm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-13-4-common-pitfalls-rules-too-strict-data-misinterpretation-business-goal-disconnect.html-fWdz_YKb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-13-culture-building-and-best-practices.html-C7WchpU4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-14-1-integration-with-project-management-jira.html-T2CP_k_t.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-14-2-integration-with-security-operations-devsecops.html-DFXc6lVX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-14-3-integration-with-operations-monitoring-shift-left.html-0N65_TAV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-14-expansion-and-integration.html-CvN5u86T.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-15-1-ai-driven-code-review-and-auto-fix.html-BSNJRQ-Z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-15-2-personalized-developer-reports-and-growth-suggestions.html-C0eo-Dfc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-15-3-resource-allocation-and-prediction-based-on-effectiveness.html-DtMgwSMH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-15-future-trends-and-aiops.html-BKpRsJyH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-2-1-dora-metrics-and-space-model.html-DGp7bFfx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-2-2-core-code-quality-metrics.html-Dz63tysN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-2-3-setting-improvement-goals.html-DzTJc1Y6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-2-4-establishing-baseline-and-benchmarking.html-Fv8hjLx2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-2-core-metrics-system-and-goals.html-Cy5QllQG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-3-1-current-situation-assessment-and-pain-point-analysis.html-BgNwUNky.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-3-2-technology-selection.html-B2bfmAsX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-1-3-3-design-principles.html-BA8q020U.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-1-3-4-evolution-roadmap.html-DsbFG7uo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-1-3-platform-strategy-and-overall-planning.html-D5t0-kt7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-1-4-1-layered-architecture.html-CYVfyNC6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-1-4-2-core-service-design.html-Cq3cyzyK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-1-4-3-high-availability-and-elasticity-design.html-rKLsneS-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-1-4-4-api-first-and-event-driven-design.html-CX5MKF9X.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-1-4-platform-architecture-and-core-capabilities.html-bll8jlfW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-1-5-1-multi-language-support.html-CDdPk0rB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-1-5-2-code-quality-analysis.html-B6NLRIT6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-1-5-3-code-security-analysis.html-Bhl4oGUM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-1-5-4-centralized-rule-management.html-D1CTKZ86.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-1-5-code-static-analysis-and-quality-guardianship.html-ORgYU1Gm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-1-6-1-unit-test-and-integration-test-coverage.html-BtKBvTP8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-1-6-2-integration-with-test-platform.html-CvcgfRyR.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-1-6-3-code-change-impact-analysis.html-Dg5_S9Nj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-1-6-4-performance-benchmarking-preventing-regression.html-B4_QsfRC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-1-6-code-dynamic-analysis-and-test-guardianship.html-zPDZMdkR.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-1-7-1-quality-thresholds-art.html-B2ST6BVf.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-1-7-2-quality-gate-strategies.html-BrBfWnaY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-1-7-3-git-integration.html-SUP4vjmK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-1-7-4-cicd-pipeline-integration.html-DyoifVkj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-1-7-code-quality-gate-and-pipeline-integration.html-ctsx24t9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-1-8-1-centralized-reporting-and-historical-trends.html-DbnO9a3e.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-1-8-2-technical-debt-management-and-quantification.html-BaSwI9ll.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-1-8-3-defect-and-vulnerability-closed-loop-management.html-DOLUamoX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-1-8-4-code-visualization.html-DSvVkqAp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-1-8-code-knowledge-base-and-intelligent-insights.html-KJVhjlc1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-1-9-1-ide-plugin-development-and-integration.html-BusiMq6h.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-1-9-2-code-templates-and-scaffolding.html-BWLyYEGp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-1-9-3-unified-code-standards-and-formatting.html-BGuOmFxz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-1-9-day-0-prevention-and-developer-experience.html-DhTH1DMe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-appendix-a-mainstream-code-analysis-tools-comparison.html-Xio-0LV9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-appendix-b-quality-gate-configuration-examples.html-stE8WoAU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-appendix-c-rd-efficiency-metrics-handbook.html-CqLuArpQ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-security-architecture-evolution.html-fIxDoTrz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-security-platform-core-value.html-ebtsdH0x.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-security-shift-left-and-devsecops.html-Bxrc2w93.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4-security-lifecycle-closure.html-Cff0-q-e.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-digital-age-security-new-paradigm.html-aWrab1kF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-10-1-1-security-situation-overview.html-DscX7Gxb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-10-1-2-case-management-and-collaboration.html-ZvxlDDtN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-10-1-3-knowledge-base-and-playbooks.html-YqvPOINh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-10-1-4-security-metrics-and-reporting.html-BYKaG-Jo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-10-1-security-operations-center-platform.html-D28MfOrl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-11-1-1-phased-implementation.html-D30_77Bh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-11-1-2-integration-with-existing-ecosystem.html-2atmWMHn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-11-1-3-change-management-and-promotion.html-CnYDpUJG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-11-1-4-continuous-training-and-red-blue-team-exercises.html-C6Ir8r-N.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-11-1-platform-implementation-and-integration.html-coA8p6lg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-12-1-1-security-policy-management.html-DoWufIq5.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-12-1-2-vulnerability-lifecycle-management.html-8b-NnrNv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-12-1-3-risk-assessment-and-governance.html-ZtdwBRRN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-12-1-4-platform-security-and-audit.html-BRw6lseF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-12-1-security-governance-and-continuous-improvement.html-DUGlvudN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-13-1-1-container-security.html-7H2s4o8t.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-13-1-2-cloud-security-posture-management.html-CaNBUJdw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-13-1-3-service-mesh-security.html-CtXniutj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-13-1-cloud-native-security.html-BviK4uh9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-14-1-2-security-prediction-and-hunting.html-B_RANfLX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-14-1-3-automated-vulnerability-exploitation-prediction.html-DMFVvgjw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-14-1-intelligent-security.html-BS-xZSxh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-15-1-1-privacy-computing-and-confidential-computing.html-ByHmpFf9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-15-1-2-supply-chain-security-and-sbom.html-D-S1oF7r.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-15-1-3-security-capability-api-and-self-service.html-8NjkuQen.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-15-1-future-trends-and-outlook.html-BnC27Mhv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-2-1-1-known-security-architecture-reference.html-BTCWRaAV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-2-1-2-compliance-requirements.html-BMoS2wOM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-2-1-3-security-domain-division-and-control-strategy.html-cpmUx9aa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-2-1-4-security-metrics-and-indicator-system.html-BDa_0uqF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-2-1-enterprise-security-architecture-and-compliance-framework.html-C9HiQREx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-3-1-1-current-status-assessment-and-gap-analysis.html-Dpo_Iggi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-3-1-2-design-principles.html-DKfjdq5n.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-3-1-3-technology-selection.html-B4a6yqYA.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-3-1-4-evolution-roadmap.html-Bw_fCBi6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-3-1-platform-strategy-and-top-level-planning.html-2KgJYRoj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-4-1-1-hardware-security-module.html-VoMkEYUz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-4-1-2-key-lifecycle-management.html-xQhyN-AN.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-4-1-3-certificate-management-service.html-C5Pa1Md4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-4-1-4-key-management-and-application-integration.html-BUJfhq51.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-4-1-cryptographic-infrastructure-and-key-management.html-BCIjElIq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-5-1-1-unified-identity-authentication.html-BFKKildJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-5-1-2-fine-grained-authorization.html-Dp9RyUUS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-5-1-3-privileged-access-management.html-CTyZuFPU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-5-1-4-multi-factor-authentication-global-mandatory-policy.html-C5OAIhXS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-5-1-identity-and-access-management.html-DPwlW0Bp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-6-1-1-data-classification-and-grading.html-CjIwVCuz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-6-1-2-data-encryption.html-Dg8lEphe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-6-1-3-data-masking.html-Bg89Zas9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-6-1-4-data-leak-prevention-monitoring-and-blocking-sensitive-data-exfiltration.html-CjsaY4X0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-6-1-4-data-leak-prevention.html-DrDPN7g_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-6-1-data-security-and-privacy-protection.html-CEGDd9Q9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-7-1-1-day-0-security-architecture-review.html-BX_JmjsF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-7-1-2-software-composition-analysis.html-2zMwG7-_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-7-1-3-static-application-security-testing.html-CFolqr3N.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-7-1-4-dynamic-and-interactive-application-security-testing.html-_bjI0RJY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-7-1-application-and-architecture-security-devsecops.html-Dz5JgK3N.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-8-1-1-unified-log-collection.html-BdeunLtB.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-8-1-2-security-log-audit.html-Bcpo5kPY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-8-1-3-endpoint-detection-and-response.html-sODTZSP6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-8-1-4-network-traffic-analysis.html-ae1GrDcy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-8-1-full-stack-observability-and-security-audit.html-C_jiHMro.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-9-1-1-security-information-and-event-management.html-CKhdxMGb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-9-1-2-response-process-orchestration.html-Dre2JvZp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-9-1-3-threat-intelligence-integration.html-Ct-q6GXI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-9-1-4-incident-response-and-playbook-management.html-CA8xm-Og.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-9-1-security-incident-response-and-automation.html-BbPmrv4K.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-appendix-a-open-source-security-tool-stack-selection-guide.html-D9d4gWQL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/074-appendix-b-security-requirements-checklist.html-D5ZHHNIe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/075-appendix-c-common-vulnerability-handling-manual.html-DYYOKMAd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/076-appendix-d-glossary.html-BWVi_omj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-from-manual-to-automation.html-BnKozwZm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-job-platform-definition-and-scope.html-8PS4mhgo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-introduction-to-job-platform.html-BGWtU_9Q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-10-1-web-console-design.html-356BfcIX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-10-platform-availability-and-user-experience.html-wpZeN7VZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-11-1-integration-with-cmdb.html-CotPrjO1.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-11-2-integration-with-monitoring-system.html-NopCm851.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-11-3-integration-with-cicd-pipeline.html-CL2lWYuE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-11-4-integration-with-itsm-process.html-C7Blwgc2.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-11-deep-integration-with-ops-system.html-CEVJMQfS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-12-1-environment-isolation.html-BIR6qSbI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-12-2-automated-deployment.html-CtaP4SxL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-12-3-smooth-upgrade-and-data-migration.html-CTCKGdUU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-12-deployment-upgrade-and-high-availability.html-Dh29SXrV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-13-1-promotion-strategy.html-CLzD7lgU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-13-2-metrics-and-optimization.html-CDHKMOp3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-13-3-documentation-and-community.html-CJBAzbz9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-13-4-common-pitfalls-and-avoidance-guide.html-D-qGEwEZ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-13-platform-operation-and-best-practices.html-C7AhbAKY.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-14-1-job-market.html-DjWvm_vC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-14-2-intelligent-parameters.html-ByNhh8-w.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-14-3-job-performance-analysis.html-U17MYCUI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-14-4-security-enhancement.html-BN1yMsn7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-14-advanced-features-and-intelligence.html-DEl6QC4d.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-15-1-serverless-implementation.html-DA9dSfjq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-15-2-chatops-integration.html-rOwPnGtm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-15-3-aiops-empowerment.html-bW4r2HUk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-15-4-edge-computing-execution.html-YERq9lDU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-15-future-evolution-and-trends.html-BVwQSG-Z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-2-1-task-model-abstraction.html-32OF6ijH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-2-2-execution-environment-abstraction.html-Cy0TNkq4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-2-core-concepts-and-abstraction.html-BonAvbY7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-3-1-target-and-scope-definition.html-BNEw7D0D.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-3-2-technology-selection.html-CkRNcd4d.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-3-platform-planning-and-design-principles.html-DEeYrdb6.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-4-1-layered-architecture.html-BsyyPr7F.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-4-platform-architecture-design.html-ChP1-xT-.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-5-1-task-scheduling-core.html-CXqN8vvD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-1-5-2-multi-protocol-adapter-design.html-C1Vo2ETK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-1-5-unified-task-execution-engine.html-BwY6z2um.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-1-6-1-security-first-design-philosophy.html-CGFUBLKc.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-1-6-credentials-and-security-management.html-D5xCBn01.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-1-7-1-data-storage-design.html-DiqvUiQp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-1-7-storage-and-observability.html-DJWuG4cO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-1-8-1-from-single-task-to-job-orchestration.html-BESBsmhx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-1-8-job-orchestration-and-process-control.html-DvUPcbsv.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-1-9-1-dynamic-target-selection.html-W88csNMm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-1-9-batch-operations-and-intelligent-selection.html-HCjs4OL_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/001-1-1-1-agile-and-devops-testing-pain-points.html-B5DixnV3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/002-1-1-2-from-tools-to-platform-the-evolution-of-testing-efficiency.html-CnTdE5aj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/003-1-1-3-what-is-a-full-lifecycle-test-platform.html-Soez3rjG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/004-1-1-4-core-values-of-platform-construction-efficiency-empowerment-and-accumulation.html-XH2902GG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/005-1-1-modern-software-testing-challenges-and-test-platform-evolution.html-BWFpueYo.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/006-1-2-1-how-to-evaluate-team-status-and-real-needs-feasibility-analysis.html-C6fZN6Je.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/007-1-2-2-developing-platform-evolution-roadmap-mvp-iteration-vs-all-at-once.html-usZ0z_cP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/008-1-2-3-core-design-principles-scalability-maintainability-user-experience.html-3yg-BekG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/009-1-2-4-technology-selection-considerations-in-house-vs-open-source-microservices-architecture.html-PcT5AlG9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/010-1-2-platform-construction-overall-planning-and-design-principles.html-BS1PKDIi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/011-1-3-1-backend-technology-selection-choosing-between-spring-boot-django-go-and-other-frameworks.html-BnDW6LIt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/012-1-3-2-frontend-technology-selection-vue-react-angular-and-modern-ui-frameworks.html-BuFDvat_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/013-1-3-3-database-design-relational-mysql-postgresql-vs-nosql-mongodb-redis-use-cases.html-SBfl-R0L.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/014-1-3-4-core-abstractions-unified-test-case-model-test-task-model-and-resource-management-model.html-DDjuXxht.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/015-1-3-fundamental-technology-stack-and-core-component-design.html-BzCZFz0G.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/016-1-4-1-test-data-pain-points-and-solutions.html-BOUCmJFj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/017-1-4-2-implementing-data-factory-and-data-pool.html-CYMAMi8j.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/018-1-4-3-multiple-data-construction-strategies-predefined-on-demand-generation-obfuscation-and-desensitization.html-DgwPV4KV.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/019-1-4-4-data-management-and-recycling-mechanisms.html-B2BwSb83.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/020-1-4-test-data-management-platform.html-DHrM2b3b.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/021-1-5-1-unified-test-case-model-managing-api-web-ui-mobile-and-performance-test-cases.html-D86L4l3S.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/022-1-5-2-test-case-lifecycle-management-creation-review-archiving-and-versioning.html-D0H2J4VS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/023-1-5-3-associating-test-cases-with-requirements-and-defects.html-Nr8fyHsb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/024-1-5-4-supporting-bdd-behavior-driven-development-and-test-case-tagging.html-DXO4AipO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/025-1-5-test-case-management-and-design-platform.html-Bmubrgzg.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/026-1-6-1-core-engine-request-initiation-and-validation-based-on-http-grpc-and-other-protocols.html-BVuufaGF.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/027-1-6-2-visual-orchestration-enabling-non-developers-to-easily-create-api-tests.html-CaDPgpfa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/028-1-6-3-advanced-features-pre-post-operations-sql-scripts-functions-parameterization-assertion-library.html-B_R3CUrk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/029-1-6-4-api-automation-and-ci-cd-integration.html-CrY03F1Y.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/030-1-6-api-testing-platform-construction.html-D9fYuzGk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/031-1-7-1-core-engine-integration-selecting-and-encapsulating-selenium-playwright-cypress.html-u7aVcb-I.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/032-1-7-2-intelligent-element-location-and-recording-function.html-DFBpWIAy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/033-1-7-3-script-management-platform-support-for-page-object-pattern.html-D4_InXEU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/034-1-7-4-combining-visual-orchestration-with-script-generation.html-C8C1lKhW.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/035-1-7-ui-automation-testing-platform-construction.html-CefyP2Lk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/036-1-8-1-installation-uninstallation-upgrade-monkey-testing.html-t7fxeryO.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/037-1-8-2-app-performance-monitoring-cpu-memory-frame-rate-traffic-collection-and-analysis.html-BAS08uNK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/038-1-8-3-compatibility-testing-integration-with-cloud-device-platforms.html-ClB1uL6k.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/039-1-8-4-wechat-mini-programs-and-h5-hybrid-app-testing-support.html-BnqScrLi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/040-1-8-mobile-specialized-testing-platform.html-CkYzjObi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/041-10-1-1-unified-task-scheduling-model-immediate-tasks-scheduled-tasks-pipeline-tasks.html-CAq-_ZWx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/042-10-1-2-resource-pooling-management-docker-k8s-dynamic-agent-allocation.html-s_ONd3ez.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/043-10-1-3-concurrency-control-queue-mechanism-and-priority-scheduling.html-CzRROX4D.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/044-10-1-4-real-time-log-collection-and-push.html-D-r2483z.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/045-11-1-1-multi-dimensional-test-reports-real-time-reports-phase-reports-comparison-reports.html-CmvRqTEa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/046-11-1-2-building-quality-dashboard-test-case-coverage-pass-rate-defect-distribution.html-BRHwvF8M.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/047-11-1-3-defining-and-calculating-quality-metrics-defects-per-thousand-lines-of-code-mttr-and-more.html-Dcp4bcXX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/048-11-1-4-driving-quality-improvement-through-data.html-Cc5WUgDl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/049-12-1-1-integration-with-jenkins-gitlab-ci-github-actions.html-CWIbUpGa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/050-12-1-2-automatic-test-triggering-strategies-gates-in-pipeline.html-Ba9-_I5M.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/051-12-1-3-test-result-feedback-and-pipeline-advancement-decision.html-BUOu76bM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/052-13-1-1-linkage-with-project-management-jira-tapd-requirement-test-case-defect-closed-loop.html-DL_PzyP8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/053-13-1-2-linkage-with-code-repository-git-code-changes-associated-with-test-cases.html-C9Lg_SG3.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/054-13-1-3-linkage-with-artifact-repository-nexus-harbor-version-management.html-C7Gh0Zp9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/055-13-1-4-linkage-with-monitoring-systems-prometheus-skywalking-production-data-feedback-testing.html-B3j1CRa7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/056-14-1-1-logging-monitoring-and-alerting-system-construction.html-pvU8mfuy.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/057-14-1-2-user-permission-management-rbac-and-operation-audit.html-3nBE0zOk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/058-14-1-3-data-backup-and-recovery-strategy.html-51qN0jVL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/059-14-1-4-platform-version-release-and-upgrade-process.html-CMrhxPsT.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/060-15-1-1-how-to-promote-within-the-team-and-acquire-early-users.html-CvuSMQxX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/061-15-1-2-writing-friendly-user-documentation-and-operation-manuals.html-eR15Nz7c.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/062-15-1-3-organize-training-and-build-community-collect-user-feedback.html-Pg-ejYgI.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/063-15-1-4-cultivating-quality-shift-left-and-automation-first-engineering-culture.html-DPnqGTt7.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/064-16-1-1-intelligent-test-case-generation.html-B3kKNet8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/065-16-1-2-defect-prediction-and-root-cause-analysis.html-DWiou6sm.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/066-16-1-3-visual-testing-and-ai-recognition.html-Djr-rcZs.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/067-16-1-4-intelligent-analysis-and-insights-of-test-results.html-akeVY6ri.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/068-17-1-1-cloud-native-test-platform.html-Dgp32-dw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/069-17-1-2-low-code-no-code-further-development.html-CIYv2t59.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/070-17-1-3-chaos-engineering-and-resilience-testing-platform.html-CgYAoyzG.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/071-17-1-4-test-as-a-service-taas-thinking.html-Ci33mTez.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/072-9-1-1-core-engine-integration-jmeter-implementation-and-distributed-transformation.html-CEle9qrX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/073-9-1-2-visual-configuration-of-pressure-test-scenarios-thread-groups-timers-listeners.html-CbWjstBp.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/074-9-1-3-real-time-monitoring-and-data-collection-system-resources-application-metrics-middleware.html-D2AsleHS.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/075-9-1-4-test-report-generation-and-bottleneck-analysis-recommendations.html-CG0HBQWU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/076-appendix-a-open-source-test-platform-projects-recommendation-and-analysis.html-CAppVVJd.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/077-appendix-b-frequently-asked-questions-faq.html-B_igQ4Vn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/078-appendix-c-keyword-index.html-B_P_rdRe.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/404.html-DAwt9e_m.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-ff3EPSAu.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-D-Y6ZNEl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-BgXfJgDQ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-BTnENrTa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-b-VaX83N.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CCER5rYz.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DRwSwKKi.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CFUJgGU9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CFbUB91X.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-U2AdTcbl.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CfXEXqPX.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CLnGRwHa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-UtPSz_sD.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-BKmB5rsq.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-D2eQwzSC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-Bs5RHUt_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-LN38O6D_.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DEvBxfqj.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-uEXcSRLx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-VOyR8PYK.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DqIwYxRU.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-C81D72mw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DVR7nsTs.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-848uDhY8.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DHcB7-O9.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CWAd9UDx.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-C54-2Ohw.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-Cv6yoV5V.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-D9S0AjrP.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-BIU6s9N4.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-zfUnpqXa.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-Dla9Rs08.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CkxBb9UM.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-Du8nUdMk.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CnG-5H3Q.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-Hhhm8np0.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CRSl3UlE.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-C_hQWQrH.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-B7gDjRXb.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-CS34QCgJ.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-ByZNlQ26.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index.html-DvVC8LqC.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/photoswipe.esm-CKV1Bsxh.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/auto-BUYG9-ss.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index-C1rb1p6e.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/flowchart-G1WAoCnn.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index-DtWMYcbt.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index-DMDrkyre.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/index-BPAdBlYL.js" as="script"><link rel="prefetch" href="/blog-plateform-design/assets/mermaid.esm.min-CeReDko1.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/blog-plateform-design/" aria-label="带我回家"><img class="vp-nav-logo" src="/blog-plateform-design/assets/images/lmxxf.png" alt><!----><span class="vp-site-name hide-in-pad">老马啸西风</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="个人成长"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:user-graduate" sizing="height" height="1em"></iconify-icon>个人成长<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/notes/" aria-label="老马随笔"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-nib" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->老马随笔<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/company/" aria-label="职业发展"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:user-tie" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->职业发展<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/methodsandmodel/" aria-label="方法模型"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:diagram-project" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->方法模型<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="财务自由"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:sack-dollar" sizing="height" height="1em"></iconify-icon>财务自由<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/money/" aria-label="财富自由"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:sack-dollar" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->财富自由<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/business/" aria-label="商业思考"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:briefcase" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->商业思考<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="推广营销"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:bullhorn" sizing="height" height="1em"></iconify-icon>推广营销<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/marketing/" aria-label="市场营销"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:bullhorn" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->市场营销<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/fans/" aria-label="媒体运营"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:photo-film" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->媒体运营<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="生活兴趣"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:heart" sizing="height" height="1em"></iconify-icon>生活兴趣<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/travel/" aria-label="环游世界"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:globe" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->环游世界<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/moive/" aria-label="电影影视"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:film" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->电影影视<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog-plateform-design/category/reading/" aria-label="读书笔记"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:book-open" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->读书笔记<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/blog-plateform-design/posts/" aria-label="全部文章"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="height" height="1em"></iconify-icon><!--]-->全部文章<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/bbhou/lmxxf-notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><!----><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->镜像安全扫描: 容器镜像的漏洞检测与合规检查</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://houbb.github.io" target="_blank" rel="noopener noreferrer">老马啸西风</a></span><span property="author" content="老马啸西风"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/8/30</span><meta property="datePublished" content="2025-08-30T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 14 分钟</span><meta property="timeRequired" content="PT14M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color1 clickable" role="navigation">CICD</span><!--]--><meta property="articleSection" content="CICD"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color1 clickable" role="navigation">CICD</span><!--]--><meta property="keywords" content="CICD"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><p>在容器化应用日益普及的今天，容器镜像已成为软件交付的核心载体。然而，容器镜像中可能包含各种安全漏洞和不合规的组件，这些风险会直接传递到生产环境中，造成严重的安全隐患。通过在CI/CD流水线中集成镜像安全扫描工具，团队能够在镜像构建阶段就发现并修复安全问题，实现&quot;安全左移&quot;的重要实践。本文将深入探讨镜像安全扫描的重要性、主流扫描工具的集成实践以及构建安全镜像的最佳策略。</p><h2 id="镜像安全扫描的重要性" tabindex="-1"><a class="header-anchor" href="#镜像安全扫描的重要性"><span>镜像安全扫描的重要性</span></a></h2><p>容器镜像安全扫描是现代DevSecOps实践中的关键环节，它能够帮助团队在软件交付的早期阶段识别和修复安全风险，从而降低整体安全风险并满足合规要求。</p><h3 id="容器镜像的安全风险" tabindex="-1"><a class="header-anchor" href="#容器镜像的安全风险"><span>容器镜像的安全风险</span></a></h3><h4 id="_1-基础镜像漏洞" tabindex="-1"><a class="header-anchor" href="#_1-基础镜像漏洞"><span>1. 基础镜像漏洞</span></a></h4><p>基础镜像（如Alpine、Ubuntu、CentOS等）本身可能包含已知的安全漏洞：</p><ul><li><strong>操作系统漏洞</strong>：Linux内核或系统库中的安全漏洞</li><li><strong>过时的软件包</strong>：未及时更新的系统软件包</li><li><strong>默认配置风险</strong>：不安全的默认系统配置</li></ul><h4 id="_2-应用依赖漏洞" tabindex="-1"><a class="header-anchor" href="#_2-应用依赖漏洞"><span>2. 应用依赖漏洞</span></a></h4><p>应用依赖的第三方库和组件可能包含安全漏洞：</p><ul><li><strong>已知CVE漏洞</strong>：公共漏洞数据库中记录的已知漏洞</li><li><strong>恶意软件包</strong>：被植入恶意代码的第三方软件包</li><li><strong>废弃组件</strong>：不再维护的老旧组件</li></ul><h4 id="_3-配置安全问题" tabindex="-1"><a class="header-anchor" href="#_3-配置安全问题"><span>3. 配置安全问题</span></a></h4><p>镜像构建过程中的配置可能引入安全风险：</p><ul><li><strong>硬编码密钥</strong>：在镜像中硬编码的密码或密钥</li><li><strong>不安全的权限设置</strong>：过高的文件或目录权限</li><li><strong>不必要的软件包</strong>：增加攻击面的非必要组件</li></ul><h3 id="镜像安全扫描的价值" tabindex="-1"><a class="header-anchor" href="#镜像安全扫描的价值"><span>镜像安全扫描的价值</span></a></h3><h4 id="_1-早期风险识别" tabindex="-1"><a class="header-anchor" href="#_1-早期风险识别"><span>1. 早期风险识别</span></a></h4><p>通过在构建阶段进行安全扫描，能够：</p><ul><li><strong>降低成本</strong>：在早期发现和修复漏洞的成本远低于生产环境修复</li><li><strong>加快响应</strong>：开发团队能够立即获得安全反馈并快速修复</li><li><strong>防止传播</strong>：阻止包含漏洞的镜像进入后续环境</li></ul><h4 id="_2-合规性保障" tabindex="-1"><a class="header-anchor" href="#_2-合规性保障"><span>2. 合规性保障</span></a></h4><p>镜像安全扫描有助于满足各种合规要求：</p><ul><li><strong>行业标准</strong>：如PCI DSS、HIPAA等对软件安全的要求</li><li><strong>内部政策</strong>：企业自定义的安全基线和标准</li><li><strong>客户要求</strong>：特定客户对供应商安全的要求</li></ul><h4 id="_3-持续安全保障" tabindex="-1"><a class="header-anchor" href="#_3-持续安全保障"><span>3. 持续安全保障</span></a></h4><p>通过自动化扫描实现持续安全保障：</p><ul><li><strong>实时监控</strong>：新发现的漏洞能够及时检测到</li><li><strong>版本追踪</strong>：完整记录镜像的安全状态历史</li><li><strong>趋势分析</strong>：分析安全风险的变化趋势</li></ul><h2 id="主流镜像安全扫描工具" tabindex="-1"><a class="header-anchor" href="#主流镜像安全扫描工具"><span>主流镜像安全扫描工具</span></a></h2><p>目前市场上有多种成熟的镜像安全扫描工具，每种工具都有其特点和适用场景。</p><h3 id="clair" tabindex="-1"><a class="header-anchor" href="#clair"><span>Clair</span></a></h3><p>Clair是CoreOS（现为Red Hat）开源的容器镜像安全扫描工具，专门用于静态分析容器镜像中的安全漏洞。</p><h4 id="clair核心架构" tabindex="-1"><a class="header-anchor" href="#clair核心架构"><span>Clair核心架构</span></a></h4><h5 id="_1-分层架构" tabindex="-1"><a class="header-anchor" href="#_1-分层架构"><span>1. 分层架构</span></a></h5><p>Clair采用分层架构设计：</p><ul><li><strong>Updater</strong>：负责从漏洞数据库获取最新的漏洞数据</li><li><strong>Notifier</strong>：在发现新漏洞时发送通知</li><li><strong>API Server</strong>：提供RESTful API供客户端查询</li><li><strong>Database</strong>：存储漏洞数据和镜像分析结果</li></ul><h5 id="_2-多数据库支持" tabindex="-1"><a class="header-anchor" href="#_2-多数据库支持"><span>2. 多数据库支持</span></a></h5><p>Clair支持多种漏洞数据库：</p><ul><li><strong>Debian Security Tracker</strong>：Debian系统漏洞数据</li><li><strong>Ubuntu CVE Tracker</strong>：Ubuntu系统漏洞数据</li><li><strong>Red Hat Security Data</strong>：Red Hat系统漏洞数据</li><li><strong>Alpine SecDB</strong>：Alpine Linux漏洞数据</li><li><strong>Oracle Linux Security Data</strong>：Oracle Linux漏洞数据</li></ul><h4 id="clair集成实践" tabindex="-1"><a class="header-anchor" href="#clair集成实践"><span>Clair集成实践</span></a></h4><h5 id="_1-clair服务部署" tabindex="-1"><a class="header-anchor" href="#_1-clair服务部署"><span>1. Clair服务部署</span></a></h5><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># docker-compose.yml - Clair服务部署</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;3.7&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  clair-db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">arminc/clair-db:latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">clair-db</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">POSTGRES_PASSWORD=password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">clair-db-data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  clair</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">quay.io/coreos/clair:v4.6.0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">clair</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">clair-db</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6060:6060&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6061:6061&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">./config/clair.yaml:/etc/clair/config.yaml</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/clair/config.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  clair-db-data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># config/clair.yaml - Clair配置文件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">clair</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  database</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pgsql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    options</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      source</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">host=clair-db port=5432 user=postgres password=password sslmode=disable</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  api</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;0.0.0.0:6060&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    healthaddr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;0.0.0.0:6061&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  updater</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    interval</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2h</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    enabledupdaters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">debian</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ubuntu</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rhel</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">alpine</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">oracle</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  notifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    attempts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    renotifyinterval</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2h</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      endpoint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://localhost:9000/webhook&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-ci-cd集成" tabindex="-1"><a class="header-anchor" href="#_2-ci-cd集成"><span>2. CI/CD集成</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># clair-scan.sh - Clair镜像扫描脚本</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;[$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;+%Y-%m-%d %H:%M:%S&#39;)] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 配置变量</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CLAIR_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CLAIR_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://localhost:6060&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">IMAGE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">${1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">IMAGE_TAG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">${2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;latest&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Usage: </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;image_name&gt; [image_tag]&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">FULL_IMAGE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_TAG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拉取镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Pulling image: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建临时目录</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TEMP_DIR</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mktemp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">trap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;rm -rf </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TEMP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EXIT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 导出镜像层</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Exporting image layers...&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> save</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TEMP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 获取镜像清单</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MANIFEST_FILE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TEMP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;manifest.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">head</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$MANIFEST_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;ERROR: Manifest file not found&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取镜像配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONFIG_DIGEST</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jq</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;.[0].Config&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$MANIFEST_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONFIG_FILE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TEMP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CONFIG_DIGEST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CONFIG_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;ERROR: Config file not found&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取镜像层信息</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LAYERS</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jq</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;.[0].Layers[]&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$MANIFEST_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 上传镜像层到Clair</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Uploading image layers to Clair...&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> layer</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $LAYERS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    LAYER_PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TEMP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$layer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LAYER_PATH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        LAYER_DIGEST</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$layer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cut</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;.&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Uploading layer: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LAYER_DIGEST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 上传层文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -X</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> POST</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            -H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Content-Type: application/octet-stream&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            --data-binary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> @&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LAYER_PATH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CLAIR_URL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/layers/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LAYER_DIGEST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 扫描镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Scanning image for vulnerabilities...&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">VULNERABILITIES</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CLAIR_URL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/layers/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LAYER_DIGEST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">?vulnerabilities&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解析扫描结果</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CRITICAL_COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$VULNERABILITIES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;[.features[].vulnerabilities[] | select(.severity==&quot;Critical&quot;)] | length&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HIGH_COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$VULNERABILITIES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;[.features[].vulnerabilities[] | select(.severity==&quot;High&quot;)] | length&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MEDIUM_COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$VULNERABILITIES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;[.features[].vulnerabilities[] | select(.severity==&quot;Medium&quot;)] | length&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Scan Results:&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;  Critical: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CRITICAL_COUNT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;  High: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$HIGH_COUNT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;  Medium: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$MEDIUM_COUNT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 生成详细报告</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">REPORT_FILE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;clair-report-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%Y%m%d-%H%M%S).json&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$VULNERABILITIES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$REPORT_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Detailed report saved to: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$REPORT_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 检查是否超过阈值</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CRITICAL_COUNT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -gt</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ] || [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$HIGH_COUNT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -gt</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;ERROR: Vulnerability threshold exceeded&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Image scan completed successfully&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="trivy" tabindex="-1"><a class="header-anchor" href="#trivy"><span>Trivy</span></a></h3><p>Trivy是Aqua Security开源的简单而全面的容器镜像安全扫描工具，具有易用性强、扫描速度快的特点。</p><h4 id="trivy核心特性" tabindex="-1"><a class="header-anchor" href="#trivy核心特性"><span>Trivy核心特性</span></a></h4><h5 id="_1-多类型扫描" tabindex="-1"><a class="header-anchor" href="#_1-多类型扫描"><span>1. 多类型扫描</span></a></h5><p>Trivy支持多种类型的扫描：</p><ul><li><strong>OS包扫描</strong>：检测操作系统包中的漏洞</li><li><strong>应用依赖扫描</strong>：检测应用依赖库中的漏洞</li><li><strong>配置检查</strong>：检查不安全的配置</li><li><strong>机密信息扫描</strong>：检测硬编码的密钥和密码</li></ul><h5 id="_2-多格式支持" tabindex="-1"><a class="header-anchor" href="#_2-多格式支持"><span>2. 多格式支持</span></a></h5><p>Trivy支持多种镜像格式：</p><ul><li><strong>Docker镜像</strong>：本地或远程Docker镜像</li><li><strong>OCI镜像</strong>：符合OCI标准的镜像</li><li><strong>文件系统</strong>：本地文件系统扫描</li><li><strong>Git仓库</strong>：Git仓库扫描</li></ul><h4 id="trivy集成实践" tabindex="-1"><a class="header-anchor" href="#trivy集成实践"><span>Trivy集成实践</span></a></h4><h5 id="_1-基本使用" tabindex="-1"><a class="header-anchor" href="#_1-基本使用"><span>1. 基本使用</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># trivy-scan.sh - Trivy镜像扫描脚本</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;[$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;+%Y-%m-%d %H:%M:%S&#39;)] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 配置变量</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">IMAGE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">${1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">IMAGE_TAG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">${2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;latest&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SEVERITY_THRESHOLD</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SEVERITY_THRESHOLD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;CRITICAL,HIGH&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">EXIT_CODE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">EXIT_CODE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">1</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Usage: </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;image_name&gt; [image_tag]&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">FULL_IMAGE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$IMAGE_TAG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拉取镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Pulling image: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 扫描镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Scanning image with Trivy...&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">trivy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> image</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    --severity</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$SEVERITY_THRESHOLD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    --exit-code</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$EXIT_CODE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    --format</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> json</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    --output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;trivy-report-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%Y%m%d-%H%M%S).json&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$FULL_IMAGE_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Image scan completed successfully&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-ci-cd集成-1" tabindex="-1"><a class="header-anchor" href="#_2-ci-cd集成-1"><span>2. CI/CD集成</span></a></h5><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># GitHub Actions中的Trivy集成</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Trivy Scan</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    branches</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">develop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  pull_request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    branches</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jobs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  scan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Scan image</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    runs-on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    steps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Checkout code</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">actions/checkout@v3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Build an image from Dockerfile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          docker build -t docker.io/my-organization/my-app:${{ github.sha }} .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Run Trivy vulnerability scanner</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aquasecurity/trivy-action@master</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          image-ref</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker.io/my-organization/my-app:${{ github.sha }}&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;sarif&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;trivy-results.sarif&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          severity</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;CRITICAL,HIGH&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Upload Trivy scan results to GitHub Security tab</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">github/codeql-action/upload-sarif@v2</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          sarif_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;trivy-results.sarif&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-高级配置" tabindex="-1"><a class="header-anchor" href="#_3-高级配置"><span>3. 高级配置</span></a></h5><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># trivy.yaml - Trivy配置文件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">scan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  skip-dirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">usr/share/doc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">usr/share/man</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  skip-files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">etc/ssl/certs/ca-certificates.crt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">vulnerability</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">os</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">library</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ignore-unfixed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ignore-policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.trivyignore</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">misconfiguration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  scanners</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">docker</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kubernetes</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  skip-policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.trivymisconfigskip</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  scanners</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aws</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gcp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">azure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">github</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  exclude-pattern</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;test.*&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 忽略特定漏洞配置</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .trivyignore</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">CVE-2018-12345</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">CVE-2020-54321</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="anchore-engine" tabindex="-1"><a class="header-anchor" href="#anchore-engine"><span>Anchore Engine</span></a></h3><p>Anchore Engine是Anchore公司开源的企业级容器镜像分析和合规检查平台，提供了全面的镜像安全和合规性检查功能。</p><h4 id="anchore核心组件" tabindex="-1"><a class="header-anchor" href="#anchore核心组件"><span>Anchore核心组件</span></a></h4><h5 id="_1-核心服务" tabindex="-1"><a class="header-anchor" href="#_1-核心服务"><span>1. 核心服务</span></a></h5><p>Anchore Engine包含以下核心服务：</p><ul><li><strong>Catalog</strong>：核心API服务，管理镜像元数据和分析状态</li><li><strong>Policy Engine</strong>：策略引擎，执行安全策略和合规检查</li><li><strong>Analyzer</strong>：分析器，分析镜像内容和提取元数据</li><li><strong>Simple Queue</strong>：任务队列，管理分析任务</li><li><strong>API Ext</strong>：扩展API服务</li></ul><h5 id="_2-策略管理" tabindex="-1"><a class="header-anchor" href="#_2-策略管理"><span>2. 策略管理</span></a></h5><p>Anchore支持灵活的策略管理：</p><ul><li><strong>Gate Actions</strong>：定义策略检查项和动作</li><li><strong>Triggers</strong>：定义触发条件</li><li><strong>Parameters</strong>：定义检查参数</li></ul><h4 id="anchore集成实践" tabindex="-1"><a class="header-anchor" href="#anchore集成实践"><span>Anchore集成实践</span></a></h4><h5 id="_1-服务部署" tabindex="-1"><a class="header-anchor" href="#_1-服务部署"><span>1. 服务部署</span></a></h5><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># docker-compose.yml - Anchore Engine部署</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;3.7&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  anchore-db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">postgres:13</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore-db</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      POSTGRES_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      POSTGRES_PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      POSTGRES_DB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore-db-data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  anchore-engine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore/anchore-engine:v1.0.0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore-engine</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore-db</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8228:8228&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">./config:/config</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ANCHORE_ENDPOINT_HOSTNAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">localhost</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ANCHORE_DB_HOST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore-db</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ANCHORE_DB_PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ANCHORE_DB_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ANCHORE_DB_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">anchore</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  anchore-db-data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-策略配置" tabindex="-1"><a class="header-anchor" href="#_2-策略配置"><span>2. 策略配置</span></a></h5><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;custom_policy&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;version&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1_0&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;comment&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Custom security policy&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;id&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;custom_policy_id&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;rules&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;id&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;critical_vulns&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;gate&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;vulnerabilities&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;trigger&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;package&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;action&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;stop&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;params&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;package_type&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;all&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;severity_comparison&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&gt;=&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;severity&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Critical&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;id&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;high_vulns&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;gate&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;vulnerabilities&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;trigger&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;package&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;action&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;warn&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;params&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;package_type&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;all&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;severity_comparison&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&gt;=&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;severity&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;High&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;id&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;unofficial_images&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;gate&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;dockerfile&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;trigger&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;instruction&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;action&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;stop&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;params&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;instruction&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;FROM&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;check&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          &quot;value&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;not_from_official&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-ci-cd集成" tabindex="-1"><a class="header-anchor" href="#_3-ci-cd集成"><span>3. CI/CD集成</span></a></h5><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/usr/bin/env python3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Anchore CI/CD集成工具</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">在CI/CD流程中集成Anchore镜像分析</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> requests</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> typing </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Dict, Any</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AnchoreClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> base_url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.base_url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> base_url.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rstrip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.auth </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (username, password)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> requests.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Session</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session.auth </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.auth</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_tag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;添加镜像到Anchore进行分析&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.base_url</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/images&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;tag&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: image_tag,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;dockerfile&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;annotations&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">data)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raise_for_status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        image_digest </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;imageDigest&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Image </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_tag</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added with digest: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_digest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> image_digest</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> wait_for_analysis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_digest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">bool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;等待镜像分析完成&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.base_url</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/images/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_digest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        start_time </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> start_time </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> timeout:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raise_for_status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            status </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;analysis_status&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Analysis status: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">status</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> status </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;analyzed&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            elif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> status </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;analysis_failed&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> False</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        raise</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> TimeoutError</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Image analysis timed out&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> evaluate_policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_digest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> policy_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; Dict[</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;评估镜像策略&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.base_url</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/images/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_digest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/check&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        params </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> policy_id:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            params[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;policyId&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> policy_id</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">params</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">params)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raise_for_status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> get_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_digest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; Dict[</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;获取镜像漏洞信息&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.base_url</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/v1/images/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_digest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/vuln/all&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raise_for_status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 配置参数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    ANCHORE_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;http://localhost:8228&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    ANCHORE_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;admin&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    ANCHORE_PASS</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;foobar&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    IMAGE_TAG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sys.argv) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> else</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;myapp:latest&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 创建Anchore客户端</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    client </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> AnchoreClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ANCHORE_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ANCHORE_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ANCHORE_PASS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 添加镜像</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        image_digest </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">add_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">IMAGE_TAG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 等待分析完成</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Waiting for image analysis to complete...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> not</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">wait_for_analysis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(image_digest):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ERROR: Image analysis failed&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 评估策略</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Evaluating image policy...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        policy_result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">evaluate_policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(image_digest)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 检查策略结果</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        final_action </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> policy_result[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;detail&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;result&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">][</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;final_action&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> final_action </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;stop&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ERROR: Image failed policy evaluation&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">dumps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(policy_result, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">indent</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 获取漏洞信息</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Getting vulnerability information...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        vulns </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(image_digest)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 统计漏洞</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        critical_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulns.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, []) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Severity&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Critical&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        high_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulns.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, []) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Severity&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;High&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Vulnerability Summary:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;  Critical: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">critical_count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;  High: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">high_count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 保存详细报告</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        with</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;anchore-report.json&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;w&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> f:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">dump</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(vulns, f, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">indent</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Image analysis completed successfully&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ERROR: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="镜像安全扫描最佳实践" tabindex="-1"><a class="header-anchor" href="#镜像安全扫描最佳实践"><span>镜像安全扫描最佳实践</span></a></h2><h3 id="_1-构建安全镜像" tabindex="-1"><a class="header-anchor" href="#_1-构建安全镜像"><span>1. 构建安全镜像</span></a></h3><h4 id="基础镜像选择" tabindex="-1"><a class="header-anchor" href="#基础镜像选择"><span>基础镜像选择</span></a></h4><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用官方最小化基础镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> alpine:3.18</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 或使用Distroless镜像（无shell和包管理器）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># FROM gcr.io/distroless/java:11</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 或使用Red Hat UBI（通用基础镜像）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># FROM registry.access.redhat.com/ubi8/ubi-minimal:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 避免使用以下不安全的基础镜像：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># FROM ubuntu:latest  # 版本不固定</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># FROM centos:latest  # 版本不固定</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="多阶段构建" tabindex="-1"><a class="header-anchor" href="#多阶段构建"><span>多阶段构建</span></a></h4><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 多阶段构建示例</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 构建阶段</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> golang:1.21-alpine </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> builder</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安装构建依赖</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> apk add --no-cache git gcc musl-dev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置工作目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 复制源代码</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> . .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 构建应用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 运行阶段</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> alpine:3.18</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安装运行时依赖</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> apk add --no-cache ca-certificates</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建非root用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> adduser -D -s /bin/sh appuser</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 复制构建产物</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --from=builder /app/main /main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更改文件所有者</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> chown appuser:appuser /main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 切换到非root用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> appuser</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 暴露端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">EXPOSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 8080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 启动应用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ENTRYPOINT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/main&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="最小化攻击面" tabindex="-1"><a class="header-anchor" href="#最小化攻击面"><span>最小化攻击面</span></a></h4><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 避免安装不必要的软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> alpine:3.18</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 只安装必需的软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> apk add --no-cache \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ca-certificates \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    tzdata</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除包管理器缓存</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Alpine Linux在使用--no-cache时自动清理</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 移除不必要的文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> rm -rf /var/cache/apk/* \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    /tmp/* \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    /var/tmp/*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置只读文件系统（运行时）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># docker run --read-only ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-扫描策略配置" tabindex="-1"><a class="header-anchor" href="#_2-扫描策略配置"><span>2. 扫描策略配置</span></a></h3><h4 id="严重性阈值设置" tabindex="-1"><a class="header-anchor" href="#严重性阈值设置"><span>严重性阈值设置</span></a></h4><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># trivy.yaml - 严重性阈值配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">scan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 忽略未修复的漏洞</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ignore-unfixed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">vulnerability</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 设置严重性阈值</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  severity</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">CRITICAL</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">HIGH</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MEDIUM</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">LOW</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 忽略特定漏洞</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ignore-policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.trivyignore</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .trivyignore - 忽略的漏洞列表</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CVE-2018-12345: 已评估为低风险</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CVE-2020-54321: 不影响当前使用场景</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ci-cd门禁配置" tabindex="-1"><a class="header-anchor" href="#ci-cd门禁配置"><span>CI/CD门禁配置</span></a></h4><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># GitLab CI中的门禁配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">stages</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">build</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">security-scan</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">deploy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">security-scan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  stage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">security-scan</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aquasec/trivy:latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    entrypoint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">trivy image --severity CRITICAL,HIGH --exit-code 1 $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  allow_failure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  only</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">master</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">develop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-持续监控与告警" tabindex="-1"><a class="header-anchor" href="#_3-持续监控与告警"><span>3. 持续监控与告警</span></a></h3><h4 id="漏洞监控脚本" tabindex="-1"><a class="header-anchor" href="#漏洞监控脚本"><span>漏洞监控脚本</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/usr/bin/env python3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">镜像漏洞监控工具</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">持续监控已部署镜像的新漏洞</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> requests</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime, timedelta</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> typing </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Dict, List</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ImageVulnerabilityMonitor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> registry_url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> trivy_server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.registry_url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> registry_url</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.trivy_server </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> trivy_server</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> get_deployed_images</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; List[</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;获取已部署的镜像列表&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 这里应该根据具体的部署环境获取镜像列表</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 示例：从Kubernetes获取</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> subprocess</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> subprocess.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &#39;kubectl&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;get&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;pods&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &#39;-o&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;jsonpath=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{.items[*].spec.containers[*].image}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            ], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">capture_output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            images </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result.stdout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()))</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> images</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Error getting deployed images: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> scan_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; Dict:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;扫描镜像&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.trivy_server</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/api/v1/scan&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;image&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: image_name</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> requests.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">data)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raise_for_status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Error scanning image </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_name</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> check_new_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> scan_result</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> Dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> since_hours</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; List[Dict]:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;检查新发现的漏洞&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        new_vulns </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        since_time </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> timedelta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">hours</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">since_hours)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        vulnerabilities </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> scan_result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Results&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, [])</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulnerabilities:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Vulnerabilities&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 检查漏洞发布时间</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    published_date </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PublishedDate&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> published_date:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        pub_time </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">fromisoformat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(published_date.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Z&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;+00:00&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pub_time </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> since_time:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                            new_vulns.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(vuln)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new_vulns</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send_alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> image_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> List[Dict]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;发送告警&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 这里可以集成具体的告警系统</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 如：Slack、Email、PagerDuty等</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ALERT: New vulnerabilities found in </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image_name</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulnerabilities:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;  - </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;VulnerabilityID&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Title&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> monitor_loop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> interval_minutes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;监控循环&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Starting image vulnerability monitoring...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 获取已部署镜像</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                images </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get_deployed_images</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Found </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(images)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> deployed images&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 扫描每个镜像</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> image </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> images:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Scanning image: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">image</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    scan_result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">scan_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(image)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> scan_result:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 检查新漏洞</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        new_vulns </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">check_new_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(scan_result)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new_vulns:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(image, new_vulns)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Waiting </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">interval_minutes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> minutes before next scan...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(interval_minutes </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> KeyboardInterrupt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Monitoring stopped&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                break</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Error during monitoring: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用示例</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    monitor </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> ImageVulnerabilityMonitor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        registry_url</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://registry.example.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        trivy_server</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://trivy-server:8080&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 运行监控循环（每小时检查一次）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    monitor.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">monitor_loop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">interval_minutes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-报告与可视化" tabindex="-1"><a class="header-anchor" href="#_4-报告与可视化"><span>4. 报告与可视化</span></a></h3><h4 id="漏洞报告生成" tabindex="-1"><a class="header-anchor" href="#漏洞报告生成"><span>漏洞报告生成</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/usr/bin/env python3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">镜像安全扫描报告生成工具</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">生成详细的漏洞分析报告</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pandas </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pd</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> typing </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Dict, List</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> VulnerabilityReportGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> scan_results</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> List[Dict]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.scan_results </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> scan_results</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> generate_summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; Dict:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;生成汇总统计&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        summary </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;total_images&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.scan_results),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;total_vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;critical&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;high&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;medium&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;low&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;unknown&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &#39;unfixed&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.scan_results:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            vulnerabilities </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">_extract_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;total_vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(vulnerabilities)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulnerabilities:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                severity </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Severity&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;UNKNOWN&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">lower</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> severity </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> summary:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    summary[severity] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;unknown&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> not</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;FixedVersion&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;unfixed&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> summary</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> _extract_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> scan_result</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> Dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; List[Dict]:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;提取漏洞信息&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        vulnerabilities </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        results </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> scan_result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Results&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, [])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> results:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Vulnerabilities&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                vulnerabilities.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">extend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulnerabilities</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> generate_detailed_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) -&gt; pd.DataFrame:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;生成详细报告&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        report_data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i, result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> enumerate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.scan_results):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            image_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ArtifactName&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Image_</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">i</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            vulnerabilities </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">_extract_vulnerabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vulnerabilities:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                report_data.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;Image&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: image_name,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;VulnerabilityID&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;VulnerabilityID&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;PkgName&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PkgName&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;InstalledVersion&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;InstalledVersion&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;FixedVersion&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;FixedVersion&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;None&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;Severity&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Severity&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;Title&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Title&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;Description&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Description&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)[:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;...&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Description&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Description&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    &#39;PrimaryURL&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: vuln.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PrimaryURL&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                })</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pd.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">DataFrame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(report_data)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> generate_html_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> output_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;生成HTML报告&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        summary </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">generate_summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        details </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">generate_detailed_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        html_content </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;html&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;head&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;title&gt;镜像安全扫描报告&lt;/title&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;meta charset=&quot;utf-8&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;style&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                body {{ font-family: Arial, sans-serif; margin: 20px; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                h1, h2 {{ color: #333; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                table {{ border-collapse: collapse; width: 100%; margin: 20px 0; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                th, td {{ border: 1px solid #ddd; padding: 8px; text-align: left; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                th {{ background-color: #f2f2f2; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                .critical {{ background-color: #ffebee; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                .high {{ background-color: #fff3e0; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                .medium {{ background-color: #fff8e1; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                .summary {{ background-color: #e8f5e8; padding: 15px; border-radius: 5px; }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;/style&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;/head&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;body&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;h1&gt;镜像安全扫描报告&lt;/h1&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;p&gt;生成时间: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">datetime.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">strftime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;%Y-%m-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> %H:%M:%S&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;div class=&quot;summary&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;h2&gt;汇总统计&lt;/h2&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;扫描镜像数量: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;total_images&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;总漏洞数量: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;total_vulnerabilities&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;严重(Critical): </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;critical&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;高(High): </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;high&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;中(Medium): </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;medium&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;低(Low): </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;low&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;未知(Unknown): </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;unknown&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                &lt;p&gt;未修复: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">summary[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;unfixed&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;/p&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;/div&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &lt;h2&gt;详细漏洞信息&lt;/h2&gt;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            {</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">details.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">to_html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">classes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;dataframe&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">escape</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;/body&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &lt;/html&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        with</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output_file, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;w&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;utf-8&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> f:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            f.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(html_content)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;HTML报告已生成: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output_file</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> generate_csv_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> output_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;生成CSV报告&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        details </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">generate_detailed_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        details.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">to_csv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output_file, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;utf-8&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;CSV报告已生成: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output_file</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用示例</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 加载扫描结果</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    scan_results </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            with</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;trivy-report-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">i</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.json&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;r&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> f:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                scan_results.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(f))</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> FileNotFoundError</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;警告: 未找到 trivy-report-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">i</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> scan_results:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        generator </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> VulnerabilityReportGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(scan_results)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 生成HTML报告</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        generator.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">generate_html_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;image-security-report.html&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 生成CSV报告</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        generator.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">generate_csv_report</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;image-security-report.csv&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;未找到扫描结果文件&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过在CI/CD流水线中集成镜像安全扫描工具，团队能够在软件交付的早期阶段识别和修复容器镜像中的安全漏洞，实现真正的&quot;安全左移&quot;。这不仅能够显著降低安全风险，还能帮助组织满足各种合规性要求。关键是要选择合适的扫描工具，建立完善的扫描策略，并将安全扫描深度集成到开发和部署流程中，从而构建安全、可靠的容器化应用交付体系。</p></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/bbhou/lmxxf-notes/edit/main/src/posts/ci-cd/018-10-1-4-image-security-scanning.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新</span><time class="vp-meta-info" datetime="2025-09-07T09:02:25.000Z" data-allow-mismatch>2025/9/7 09:02</time></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1557740299@qq.com">bbhou</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">我是老马，期待与你的下次重逢</div><div class="vp-copyright">Copyright © 2025 老马啸西风 </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/blog-plateform-design/assets/app-JcJB06c7.js" defer></script>
  </body>
</html>
